<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda Ecommerce</title>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@100..900&display=swap" rel="stylesheet">
</head>

<body>
    <header class="header">
        <a href="index.html">
            <img class="header__logo" src="./img/logo.png" alt="logoTipo">
        </a>
    </header>
    <nav class="navegacion">
        <a href="index.html" class="navegacion__enlace">Tienda</a>
        <a href="nosotros.html" class="navegacion__enlace navegacion__enlace--activo">Nosotros</a>
        <div class="carrito-contenedor"></div>
        <a href="carrito.html" class="navegacion__enlace">Ver Carrito</a>
        <div id="carrito-preview"></div> <!-- Este contenedor muestra los productos -->
        </div>
    </nav>
    <main class="contenedor">
        <h1></h1> <!-- Este se actualizará dinámicamente con el nombre del producto -->
        <div class="articulo">
            <img src="" alt="" class="articulo__imagen">
            <!-- Este se actualizará dinámicamente con la imagen del producto -->
            <div class="articulo__contenido">
                <p></p> <!-- Este se actualizará dinámicamente con la descripción del producto -->
                <form id="form-producto" class="formulario">
                    <select class="formulario__campo" id="talla">
                        <option disabled selected>Seleccionar talla</option>
                        <option value="Chica">Chica</option>
                        <option value="Mediana">Mediana</option>
                        <option value="Grande">Grande</option>
                    </select>
                    <input id="cantidad" class="formulario__campo" type="number" placeholder="Cantidad" min="1">
                    <input class="formulario__submit" type="submit" value="Agregar al carrito">
                </form>
            </div>
        </div>
    </main>
    <footer class="footer">
        <p class="footer__texto">
            Todos los derechos reservados. @Bruno_tz
        </p>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Obtener los parámetros de la URL
            const params = new URLSearchParams(window.location.search);
            const nombreProducto = params.get('name');
            const precioProducto = params.get('price');
            const imagenProducto = params.get('image');

            // Actualizar el contenido de la página con los detalles del producto
            const tituloProducto = document.querySelector('h1');
            const imagen = document.querySelector('.articulo__imagen');
            const descripcionProducto = document.querySelector('.articulo__contenido p');

            tituloProducto.textContent = nombreProducto; // Mostrar el nombre del producto
            imagen.src = imagenProducto; // Mostrar la imagen del producto
            imagen.alt = nombreProducto; // Establecer un texto alternativo
            descripcionProducto.textContent = `Precio: $${precioProducto}`; // Mostrar el precio del producto

            // Manejar la lógica del carrito
            const formulario = document.getElementById('form-producto');
            const carritoPreview = document.getElementById('carrito-preview');

            // Función para mostrar productos del carrito en el preview
            function actualizarCarritoPreview() {
                const carrito = JSON.parse(localStorage.getItem('carrito')) || [];
                carritoPreview.innerHTML = '';

                if (carrito.length === 0) {
                } else {
                    carrito.forEach(producto => {
                        const productoDiv = document.createElement('div');
                        productoDiv.classList.add('producto-preview');

                        productoDiv.innerHTML = `
                            <p>${producto.nombre} (x${producto.cantidad}) - $${producto.precio}</p>
                        `;
                        carritoPreview.appendChild(productoDiv);
                    });
                }
            }

            // Cargar el carrito al cargar la página
            actualizarCarritoPreview();

            // Manejar el evento de agregar al carrito
            formulario.addEventListener('submit', function (event) {
                event.preventDefault(); // Evitar el envío del formulario

                // Obtener talla y cantidad
                const tallaSeleccionada = document.getElementById('talla').value;
                const cantidad = parseInt(document.getElementById('cantidad').value, 10);

                // Validar que se haya seleccionado una cantidad válida
                if (isNaN(cantidad) || cantidad <= 0 || tallaSeleccionada === "") {
                    window.alert('Por favor, selecciona una talla y al menos un artículo.');
                    return; // Detener la ejecución si la cantidad no es válida o talla no seleccionada
                }

                // Crear objeto del producto a agregar al carrito
                const producto = {
                    nombre: nombreProducto,
                    precio: precioProducto,
                    imagen: imagenProducto,
                    talla: tallaSeleccionada,
                    cantidad: cantidad
                };

                // Agregar el producto a localStorage
                let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
                carrito.push(producto);
                localStorage.setItem('carrito', JSON.stringify(carrito));

                // Actualizar la vista del carrito
                actualizarCarritoPreview();

                // Mostrar confirmación de agregado
                window.alert('Producto agregado al carrito');

                window.location.href = 'index.html';
            });
        });
    </script> <!-- Asegúrate de incluir tu archivo JS -->
</body>

</html>